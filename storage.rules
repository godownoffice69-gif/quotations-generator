rules_version = '2';

// ========================================
// FIREBASE STORAGE RULES
// ========================================
// Controls access to Firebase Storage (file uploads/downloads)

service firebase.storage {
  match /b/{bucket}/o {

    // ========================================
    // PRODUCT IMAGES FOLDER
    // ========================================
    // Stores product photos uploaded from admin panel
    // Used for displaying product images on quotation website
    match /products/{imageId} {
      // Anyone can read/download product images (needed for quotation website)
      allow read: if true;

      // Only authenticated users can upload/update/delete product images
      allow write, delete: if request.auth != null
                          && request.resource.size < 5 * 1024 * 1024  // Max 5MB
                          && request.resource.contentType.matches('image/.*');  // Images only
    }

    // ========================================
    // VIDEO UPLOADS FOLDER (if needed in future)
    // ========================================
    match /videos/{videoId} {
      // Anyone can read videos (for website display)
      allow read: if true;

      // Only authenticated users can upload videos
      allow write, delete: if request.auth != null
                          && request.resource.size < 100 * 1024 * 1024;  // Max 100MB
    }

    // ========================================
    // ADVERTISEMENTS FOLDER
    // ========================================
    match /advertisements/{adId} {
      // Anyone can read ads (for website display)
      allow read: if true;

      // Only authenticated users can upload/manage ads
      allow write, delete: if request.auth != null
                          && request.resource.size < 10 * 1024 * 1024;  // Max 10MB
    }

    // ========================================
    // QUOTATION ATTACHMENTS (if needed)
    // ========================================
    match /quotations/{quotationId}/{fileName} {
      // Only authenticated users can read quotation attachments
      allow read: if request.auth != null;

      // Only authenticated users can upload quotation attachments
      allow write, delete: if request.auth != null
                          && request.resource.size < 20 * 1024 * 1024;  // Max 20MB
    }

    // ========================================
    // DEFAULT DENY ALL
    // ========================================
    // Block access to everything else for security
    match /{allPaths=**} {
      allow read, write: if false;
    }
  }
}
